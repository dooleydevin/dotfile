{{ define "diff" -}}
<div><!-- TODO diff is displaying with extra newlines on some files like ps1_config -->
  <div class="file-controls flex-between">
    <strong>{{ .Data.path }}</strong>
    {{- if .Data.commits }}
    {{- $on := .Data.on }}
    {{- $against := .Data.against }}
    <em>Compare Hashes</em>
    <form class="inline">
      <label for="on">On</label>
      <select id="on" name="on">
        {{ range .Data.commits }}
        <option{{ if eq .Hash $on }} selected="selected"{{ end }} value="{{ .Hash }}" >
          {{ shortenHash .Hash }}
          "{{ .Message }}"
        </option>
        {{- end }}
      </select>
      <label for="against">Against</label>
      <select name="against" id="against">
        {{- range .Data.commits }}
        <option{{ if eq .Hash $against }} selected="selected"{{ end }} value="{{ .Hash }}">
          {{ shortenHash .Hash }}
          "{{ .Message }}"
        </option>
        {{- end }}
      </select>
      <button>Diff</button>
    </form>
    {{- end }}
  </div>
  <pre class="file-content"><code>
    {{- range .Data.diffs -}}
    {{- if eq .Type 1 -}}
    <ins>{{- .Text -}}</ins>
    {{- else if eq .Type 0 -}}
    <span>{{- shortenEqualText .Text -}}</span>
    {{- else if eq .Type -1 -}}
    <del>{{- .Text -}}</del>
    {{- end }}
    {{- end }}
  </code></pre>
</div>
{{- end }}
